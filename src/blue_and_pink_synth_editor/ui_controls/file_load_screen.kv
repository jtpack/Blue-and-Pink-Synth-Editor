#:kivy 2.1.0
#:import C kivy.utils.get_color_from_hex
#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import NoTransition kivy.uix.screenmanager.NoTransition


<FileLoadScreen>:
    name: 'file_load'

    canvas.before:
        Color:
            rgba: C('#092042FF')
        SmoothRectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        padding: (root.height * 0.008, 0, root.height * 0.008, root.height * 0.008)
        spacing: root.height * 0.008
        corner_radius: root.height * 0.015

        FileChooserListView:
            id: filechooser
            path: str(app._curr_preset_file_path.parent if app._curr_preset_file_path is not None else app._presets_directory_path)
            dirselect: False
            filters: ['*.txt', '*.TXT']
            sort_func: app.file_list_sort_func

        BoxLayout:
            size_hint_y: 1/8
            spacing: self.parent.spacing
            corner_radius: self.parent.corner_radius

            FileButton:
                corner_radius: self.parent.corner_radius
                text_size: self.size
                font_size: self.height * 0.3
                halign: 'center'
                valign: 'middle'
                text: "CANCEL"
                on_release:
                    app.root.transition = NoTransition()
                    app.root.current = 'main'
                    app.set_curr_screen_name('main')
                    self.mouse_inside_bounds = False

            FileButton:
                corner_radius: self.parent.corner_radius
                text_size: self.size
                font_size: self.height * 0.3
                halign: 'center'
                valign: 'middle'
                text: "OK"
                disabled: len(filechooser.selection) == 0
                on_release:
                    app.on_file_load_dialog(filechooser.path, filechooser.selection)
                    app.root.transition = NoTransition()
                    app.root.current = 'main'
                    app.set_curr_screen_name('main')
                    self.mouse_inside_bounds = False


<FileButton@ButtonBehavior+Label>:
    corner_radius: 0
    canvas.before:
        Color:
            rgba: C('#257CFFFF') if not root.disabled else C('#43454AFF')

        SmoothRoundedRectangle:
            pos: root.pos
            size: root.width, root.height
            radius: [root.corner_radius, root.corner_radius, root.corner_radius, root.corner_radius]
